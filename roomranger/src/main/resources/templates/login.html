<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <th:replace fragment="fragments :: fragments"></th:replace>
</head>
<body style="background-color: Coral;">

<form action="/login" method="post" th:object="${loginForm}" onsubmit="return validateLogin();">

    <label for="username">Username:</label>
    <input type="text" id="username" name="username" th:field="*{username}" autocomplete="username" required><br>
    <span th:if="${#fields.hasErrors('username')}" th:errors="*{username}" class="error-message"></span><br>

    <label for="password">Password:</label>
    <div class="password-container">
        <input type="password" id="password" name="password" th:field="*{password}" autocomplete="current-password" required>
        <span class="eye-icon" onclick="togglePasswordVisibility('password')" alt="Toggle Password Visibility">üëÅÔ∏è</span>
    </div><br>

    <button type="submit">Done</button>
    <button type="submit">Cancel</button>

    <!-- Option to change and save password -->
    <button type="button" onclick="changeAndSavePassword()">Change and Save Password</button>
</form>

<script th:inline="javascript">
    function togglePasswordVisibility(fieldId) {
        let passwordInput = document.getElementById(fieldId);
        let fieldType = passwordInput.type;
        passwordInput.type = fieldType === "text" ? "password" : "text";
    }
</script>

<script th:inline="javascript">
    function validateLogin() {
        let username = document.getElementById('username').value;
        let password = document.getElementById('password').value;

        // Validation logic for username
        if (username.length < 3 || username.length > 30) {
            alert("Invalid username. Must be between 3 and 30 characters.");
            return false;
        }

        // Validation logic for password
        if (password.length < 5 || password.length > 30) {
            alert("Invalid password. Must be between 5 and 30 characters.");
            return false;
        }

        // If all validations pass, return true
        return true;
    }

    function changeAndSavePassword() {
        // Add logic for changing and saving password
        let newPassword = prompt("Enter new password:");
               alert("Password changed and saved successfully!");
    }
</script>

</body>
</html>
